manifest {
    mainScript = 'main.nf'
}

params {    
    fast5 = ''
    reads = ''
    assembler = ''
    subSamplingDepth = 10
    raconRounds = 4
    output = ''
    cpus = 4
    mem = "8GB"
    medakaModel = 'r941_min_fast'
}

profiles {

    // conda profile
    conda {
        executor = 'local'
        docker.enabled = false

        process {
            withName: trimmingAdapters {
        		conda = 'environments/trimmingAdapters.yaml'
        		cpus = params.cpus
        		memory = params.mem
        	}

            withName: assemblingReads {
                if (params.assembler == 'miniasm') {
                    conda = 'environments/assemblyWithMiniasm.yaml'
                }
                else {
                    conda = 'environments/assemblyRedbean.yaml'
                }
                cpus = params.cpus
                memory = params.mem
            }

            withName: subsamplingReads {
                conda = 'environments/readSubsampling.yaml'
                cpus = params.cpus
                memory = params.mem
            }

            withName: polishingWithoutSignal {
                conda = 'environments/polishingWithoutSignal.yaml'
                cpus = params.cpus
                memory = params.mem
            }

            withName: polishingWithSignal {
                conda = 'environments/polishingWithSignal.yaml'
                cpus = params.cpus
                memory = params.mem
            }

            withName: assessAssemblies {
                conda = 'environments/assessAssemblies.yaml'
                cpus = params.cpus
                memory = params.mem
            }
        }
    }

    // TODO: docker profile
    docker {
        executor = 'local'
        docker.enabled = true

        process {
            withName: trimmingAdapters {
        		container = "hadrieng/porechop:0.2.3"
        		cpus = params.cpus
        		memory = params.mem
        	}

        }
    }
}
